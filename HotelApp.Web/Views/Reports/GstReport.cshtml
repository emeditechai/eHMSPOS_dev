@model HotelApp.Web.ViewModels.GstReportViewModel
@{
    ViewData["Title"] = "GST Report";
}

@section Styles {
    <link rel="stylesheet" href="~/css/room-dashboard.css" asp-append-version="true" />
}

<div class="page-header">
    <h2><i class="fas fa-file-invoice"></i> GST Report</h2>
</div>

<div class="filters-container" style="margin-bottom: 18px;">
    <div style="display:flex; gap:12px; flex-wrap: wrap; align-items:flex-end; justify-content: space-between;">
        <div>
            <div style="font-weight:900; color:#0f172a;">@(string.IsNullOrWhiteSpace(Model.HotelName) ? "Hotel" : Model.HotelName)</div>
            @if (!string.IsNullOrWhiteSpace(Model.HotelAddress))
            {
                <div class="subtext" style="margin-top:4px;">@Model.HotelAddress</div>
            }
            <div class="subtext" style="margin-top:4px;">GSTIN: @(string.IsNullOrWhiteSpace(Model.GSTCode) ? "-" : Model.GSTCode)</div>
        </div>

        <form method="get" action="@Url.Action("GstReport", "Reports")" style="display:flex; flex-wrap:wrap; gap:12px; align-items:flex-end;">
            <div>
                <label for="fromDate" style="display:block; font-weight:700; color:#1f2937; margin-bottom:6px;">From Date</label>
                <input id="fromDate" name="fromDate" type="date" class="form-control" value="@Model.FromDate.ToString("yyyy-MM-dd")" />
            </div>

            <div>
                <label for="toDate" style="display:block; font-weight:700; color:#1f2937; margin-bottom:6px;">To Date</label>
                <input id="toDate" name="toDate" type="date" class="form-control" value="@Model.ToDate.ToString("yyyy-MM-dd")" />
            </div>

            <div style="display:flex; gap:10px; align-items:flex-end;">
                <button class="btn-filter-apply" type="submit">
                    <i class="fas fa-filter"></i> Apply
                </button>
                <a class="btn-filter-clear" href="@Url.Action("GstReport", "Reports")">
                    <i class="fas fa-undo"></i> Reset
                </a>
            </div>
        </form>
    </div>
</div>

<div class="status-cards booking-status-cards" style="margin-bottom: 26px;">
    <div class="status-card available">
        <h3>Total Bookings</h3>
        <div class="value">@Model.Summary.TotalBookings</div>
    </div>

    <div class="status-card occupied">
        <h3>Taxable Value</h3>
        <div class="value">₹@Model.Summary.TotalTaxableValue.ToString("N0")</div>
    </div>

    <div class="status-card maintenance">
        <h3>Total GST</h3>
        <div class="value">₹@Model.Summary.TotalGST.ToString("N0")</div>
    </div>

    <div class="status-card cleaning">
        <h3>Paid Amount</h3>
        <div class="value">₹@Model.Summary.TotalPaidAmount.ToString("N0")</div>
    </div>
</div>

<div class="filters-container" style="margin-bottom: 18px;">
    <div style="display:flex; gap:12px; flex-wrap: wrap; align-items:center; justify-content: space-between;">
        <div>
            <div style="font-weight:700; color:#1f2937;">GST Register</div>
            <div class="subtext" style="margin-top:4px;">CGST: ₹@Model.Summary.TotalCGST.ToString("N0") • SGST: ₹@Model.Summary.TotalSGST.ToString("N0")</div>
        </div>
    </div>
</div>

<div class="table-container" style="overflow: visible;">
    <table class="data-table" id="gstReportTable">
        <thead>
            <tr>
                <th>Payment Date</th>
                <th>Booking No</th>
                <th>Guest</th>
                <th>Room Type</th>
                <th class="text-end">Taxable Value</th>
                <th class="text-end">CGST</th>
                <th class="text-end">SGST</th>
                <th class="text-end">GST</th>
                <th class="text-end">Paid Amount</th>
                <th>Booking Status</th>
                <th>Payment Status</th>
                <th>Created By</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var row in Model.Rows)
        {
            <tr>
                <td>@row.PaidOn.ToString("dd MMM yyyy")</td>
                <td>@(string.IsNullOrWhiteSpace(row.BookingNumber) ? "-" : row.BookingNumber)</td>
                <td>@(string.IsNullOrWhiteSpace(row.GuestName) ? "-" : row.GuestName)</td>
                <td>@(string.IsNullOrWhiteSpace(row.RoomType) ? "-" : row.RoomType)</td>
                <td class="text-end">₹@row.TaxableValue.ToString("N2")</td>
                <td class="text-end">₹@row.CGSTAmount.ToString("N2")</td>
                <td class="text-end">₹@row.SGSTAmount.ToString("N2")</td>
                <td class="text-end">₹@row.GSTAmount.ToString("N2")</td>
                <td class="text-end">₹@row.PaidAmount.ToString("N2")</td>
                <td>@(string.IsNullOrWhiteSpace(row.Status) ? "-" : row.Status)</td>
                <td>@(string.IsNullOrWhiteSpace(row.PaymentStatus) ? "-" : row.PaymentStatus)</td>
                <td>@(string.IsNullOrWhiteSpace(row.CreatedBy) ? "-" : row.CreatedBy)</td>
            </tr>
        }
        </tbody>
    </table>
</div>
