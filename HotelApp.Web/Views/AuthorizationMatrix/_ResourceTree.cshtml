@model List<HotelApp.Web.ViewModels.ResourceNodeVm>

@if (Model == null || Model.Count == 0)
{
    <div class="text-muted">No resources found. Run seed script 90_SeedAuthorizationResources_FromNavMenu.sql</div>
}
else
{
    <ul style="list-style:none; padding-left: 0; margin: 0;">
        @foreach (var node in Model)
        {
            <li style="padding: 10px 0; border-bottom: 1px solid #f1f1f1;">
                <div style="display:flex; align-items:center; gap:12px; flex-wrap:wrap;">
                    <div style="min-width: 380px; flex: 1;">
                        <div style="font-weight:700;">@node.Title <span class="text-muted" style="font-weight:400;">(@node.ResourceType)</span></div>
                        <div class="text-muted" style="font-size: 12px;">@node.ResourceKey</div>
                        @if (!string.IsNullOrWhiteSpace(node.Controller) && !string.IsNullOrWhiteSpace(node.Action))
                        {
                            <div class="text-muted" style="font-size: 12px;">@node.Controller/@node.Action</div>
                        }
                    </div>

                    <input type="hidden" name="resourceIds" value="@node.Id" />
                    <select name="decisions" class="form-control" style="width: 160px;">
                        <option value="Inherit" selected="@(node.Decision == "Inherit")">Inherit</option>
                        <option value="Allow" selected="@(node.Decision == "Allow")">Allow</option>
                        <option value="Deny" selected="@(node.Decision == "Deny")">Deny</option>
                    </select>
                </div>

                @if (node.Children != null && node.Children.Count > 0)
                {
                    <div style="padding-left: 22px; padding-top: 8px;">
                        <partial name="_ResourceTree" model="node.Children" />
                    </div>
                }
            </li>
        }
    </ul>
}
